@tailwind base;
@tailwind components;
@tailwind utilities;

/* Safe Area Insets for mobile notches */
@supports (padding-top: env(safe-area-inset-top)) {
  .pt-safe {
    padding-top: env(safe-area-inset-top);
  }
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }
  .pl-safe {
    padding-left: env(safe-area-inset-left);
  }
  .pr-safe {
    padding-right: env(safe-area-inset-right);
  }
  .px-safe {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  .py-safe {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* Hommi.gr Design System - Mediterranean-inspired colors and modern aesthetics */

@layer base {
  /* Shimmer loading animation */
  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }

  /* Map hover popup animations */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Marker pulse animation */
  @keyframes marker-pulse {
    0% {
      transform: scale(1);
      box-shadow: 0 0 0 0 hsl(var(--primary) / 0.7);
    }
    50% {
      transform: scale(1.08);
      box-shadow: 0 0 0 6px hsl(var(--primary) / 0);
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 0 0 hsl(var(--primary) / 0);
    }
  }

  /* Marker bounce animation */
  @keyframes marker-bounce {
    0%, 100% {
      transform: translateY(0);
    }
    25% {
      transform: translateY(-4px);
    }
    75% {
      transform: translateY(-2px);
    }
  }

  /* Shimmer animation for skeleton loaders */
  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  /* Float animation for elements */
  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  /* Slow shimmer for hover effects */
  @keyframes shimmer-slow {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  /* Scale in with delay */
  @keyframes scale-in-delayed {
    0% {
      transform: scale(0.95);
      opacity: 0;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Message animations */
  @keyframes message-slide-in {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes typing-dot {
    0%, 60%, 100% { 
      opacity: 0.3;
      transform: translateY(0);
    }
    30% { 
      opacity: 1;
      transform: translateY(-4px);
    }
  }

  .animate-message-slide-in {
    animation: message-slide-in 0.3s ease-out;
  }

  .animate-typing-dot {
    animation: typing-dot 1.4s ease-in-out infinite;
  }

  .animation-delay-0 {
    animation-delay: 0ms;
  }

  .animation-delay-150 {
    animation-delay: 150ms;
  }

  .animation-delay-300 {
    animation-delay: 300ms;
  }

  .mapboxgl-popup-content {
    padding: 0 !important;
    border-radius: 12px !important;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
    overflow: hidden !important;
    max-width: 300px !important;
  }

  .map-popup-container {
    width: 280px;
    max-width: 280px;
    overflow: hidden;
    border-radius: 12px;
  }

  .map-popup-container img {
    display: block;
  }

  /* Map popup and listing card arrow buttons */
  .map-popup-container button,
  .group button[aria-label*="photo"] {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    line-height: 1 !important;
  }

  .mapboxgl-popup-tip {
    display: none;
  }

  :root {
    /* Typography Scale - Responsive clamp() values */
    --h1: clamp(2.125rem, 1.4rem + 2vw, 2.75rem);      /* 34-44px */
    --h2: clamp(1.75rem, 1.2rem + 1.5vw, 2.25rem);     /* 28-36px */
    --h3: clamp(1.375rem, 1.05rem + 1vw, 1.75rem);     /* 22-28px */
    --h4: clamp(1.25rem, 1.15rem + 0.5vw, 1.375rem);   /* 20-22px */
    --body-l: 1.125rem;                                  /* 18px */
    --body: 1rem;                                        /* 16px */
    --small: 0.875rem;                                   /* 14px */
    --micro: 0.75rem;                                    /* 12px */
    --button: 0.9375rem;                                 /* 15px */
    --caption: 0.8125rem;                                /* 13px */
    
    /* OpenType Features */
    --num: "tnum" 1, "cv11" 1, "ss01" 0;
    
    /* Core Mediterranean palette */
    --background: 0 0% 100%;
    --foreground: 220 25% 8%;

    /* Surface colors */
    --card: 0 0% 100%;
    --card-foreground: 220 25% 8%;
    --surface-elevated: 210 40% 98%;

    --popover: 0 0% 100%;
    --popover-foreground: 220 25% 8%;

    /* Brand colors - Mediterranean blue */
    --primary: 208 88% 55%;
    --primary-foreground: 0 0% 100%;
    --primary-hover: 208 88% 45%;
    --primary-light: 208 88% 65%;
    --primary-lighter: 208 88% 88%;

    /* Secondary - Warm sand */
    --secondary: 35 25% 92%;
    --secondary-foreground: 220 25% 8%;
    --secondary-hover: 35 25% 88%;

    /* Accent - Mediterranean green */
    --accent: 145 65% 45%;
    --accent-foreground: 0 0% 100%;
    --accent-light: 145 65% 85%;

    /* Neutral tones */
    --muted: 210 40% 96%;
    --muted-foreground: 220 15% 55%;
    --muted-darker: 220 15% 45%;

    /* Borders */
    --border: 220 15% 88%;
    --border-subtle: 220 15% 93%;
    --input: 220 15% 88%;
    --ring: 208 88% 55%;

    /* States */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --success: 145 65% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 35 90% 55%;
    --warning-foreground: 220 25% 8%;

    /* Chart colors */
    --chart-1: 208 88% 55%;
    --chart-2: 145 65% 45%;
    --chart-3: 35 90% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 0 84% 60%;

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-elevated: 0 12px 32px rgba(0, 0, 0, 0.12);

    /* Border radius */
    --radius: 0.5rem;
  }

  .dark {
    --background: 222 47% 11%;
    --foreground: 210 40% 98%;

    --card: 222 47% 11%;
    --card-foreground: 210 40% 98%;
    --surface-elevated: 220 40% 15%;

    --popover: 222 47% 11%;
    --popover-foreground: 210 40% 98%;

    --primary: 208 88% 55%;
    --primary-foreground: 0 0% 100%;
    --primary-hover: 208 88% 65%;

    --secondary: 217 33% 17%;
    --secondary-foreground: 210 40% 98%;
    --secondary-hover: 217 33% 20%;

    --accent: 145 65% 45%;
    --accent-foreground: 0 0% 100%;

    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;

    --border: 217 33% 22%;
    --input: 217 33% 22%;
    --ring: 208 88% 55%;

    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;

    --chart-1: 208 88% 55%;
    --chart-2: 145 65% 45%;
    --chart-3: 35 90% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 0 84% 60%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Typography */
  h1 { font-size: var(--h1); font-weight: 700; line-height: 1.2; letter-spacing: -0.02em; }
  h2 { font-size: var(--h2); font-weight: 700; line-height: 1.25; letter-spacing: -0.015em; }
  h3 { font-size: var(--h3); font-weight: 600; line-height: 1.3; }
  h4 { font-size: var(--h4); font-weight: 600; line-height: 1.35; }

  /* Scrollbar styles */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Focus states */
  *:focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }

  /* Selection */
  ::selection {
    @apply bg-primary/20 text-foreground;
  }
}

@layer utilities {
  /* Animation delays */
  .animation-delay-100 { animation-delay: 100ms; }
  .animation-delay-200 { animation-delay: 200ms; }
  .animation-delay-300 { animation-delay: 300ms; }
  .animation-delay-400 { animation-delay: 400ms; }
  .animation-delay-500 { animation-delay: 500ms; }

  /* Touch-friendly utilities */
  .touch-manipulation {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  /* Smooth scrolling with momentum on iOS */
  .scroll-smooth {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Enhanced snap scrolling for mobile carousel */
  .snap-x {
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }

  .snap-center {
    scroll-snap-align: center;
    scroll-snap-stop: always;
  }

  /* Prevent overscroll on mobile carousel */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
    overscroll-behavior-x: contain;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Custom animations */
  .animate-shimmer {
    animation: shimmer 2s infinite;
    background: linear-gradient(
      90deg,
      transparent 0%,
      hsl(var(--muted-foreground) / 0.05) 50%,
      transparent 100%
    );
    background-size: 200% 100%;
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  .animate-shimmer-slow {
    animation: shimmer-slow 2s ease-in-out;
  }

  .animate-scale-in-delayed {
    animation: scale-in-delayed 0.5s ease-out forwards;
  }
}

/* Mapbox overrides */
.mapboxgl-ctrl-bottom-left,
.mapboxgl-ctrl-bottom-right {
  @apply pb-4;
}

.mapboxgl-ctrl button {
  @apply touch-manipulation;
}

/* Map Marker Styles */
.map-price-marker {
  cursor: pointer;
  z-index: 1;
  will-change: transform;
}

.price-bubble {
  padding: 6px 12px;
  background: hsl(var(--card));
  color: hsl(var(--card-foreground));
  border: 2px solid hsl(var(--border));
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
              background-color 0.2s ease-out,
              color 0.2s ease-out,
              border-color 0.2s ease-out,
              box-shadow 0.2s ease-out;
  user-select: none;
  will-change: transform;
}

/* Hover state - from list card hover */
.price-bubble.hovered {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  border-color: hsl(var(--primary));
  transform: scale(1.15) translateY(-3px);
  box-shadow: 0 4px 16px hsl(var(--primary) / 0.4);
  z-index: 10;
  animation: marker-bounce 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Selected state - from clicking map or carousel */
.price-bubble.selected {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  border-color: hsl(var(--primary));
  transform: scale(1.12);
  box-shadow: 0 4px 16px hsl(var(--primary) / 0.4);
  z-index: 10;
}

/* Active state - temporary pulse effect */
.price-bubble.active {
  animation: marker-pulse 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Hover on marker itself */
.map-price-marker:hover .price-bubble {
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.map-price-marker:hover .price-bubble:not(.hovered):not(.selected) {
  background: hsl(var(--accent));
  color: hsl(var(--accent-foreground));
  border-color: hsl(var(--accent));
}

/* React Query DevTools (hide in production) */
.ReactQueryDevtools {
  @apply hidden;
}

/* Custom utility for vaul drawer */
[vaul-drawer] {
  touch-action: none;
}

[vaul-drawer][vaul-drawer-direction="bottom"] {
  @apply rounded-t-2xl;
}
